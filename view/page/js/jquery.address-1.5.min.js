(function(e){e.address=function(){var t=function(t){var n=e.extend(e.Event(t),function(){var t={},n=e.address.parameterNames();for(var r=0,i=n.length;r<i;r++){t[n[r]]=e.address.parameter(n[r])}return{value:e.address.value(),path:e.address.path(),pathNames:e.address.pathNames(),parameterNames:n,parameters:t,queryString:e.address.queryString()}}.call(e.address));e(e.address).trigger(n);return n},n=function(e){return Array.prototype.slice.call(e)},r=function(t,n,r){e().bind.apply(e(e.address),Array.prototype.slice.call(arguments));return e.address},i=function(t,n){e().unbind.apply(e(e.address),Array.prototype.slice.call(arguments));return e.address},s=function(){return U.pushState&&B.state!==N},o=function(){return("/"+z.pathname.replace(new RegExp(B.state),"")+z.search+(u()?"#"+u():"")).replace(V,"/")},u=function(){var e=z.href.indexOf("#");return e!=-1?h(z.href.substr(e+1),H):""},a=function(){return s()?o():u()},f=function(){try{return top.document!==N&&top.document.title!==N?top:window}catch(e){return window}},l=function(){return"javascript"},c=function(e){e=e.toString();return(B.strict&&e.substr(0,1)!="/"?"/":"")+e},h=function(e,t){if(B.crawlable&&t){return(e!==""?"!":"")+e}return e.replace(/^\!/,"")},p=function(e,t){return parseInt(e.css(t),10)},d=function(){if(!tt){var e=a(),t=decodeURI(ot)!=decodeURI(e);if(t){if(F&&j<7){z.reload()}else{if(F&&!K&&B.history){X(y,50)}_old=ot;ot=e;v(H)}}}},v=function(e){var n=t(M),r=t(e?_:D);X(g,10);if(n.isDefaultPrevented()||r.isDefaultPrevented()){m()}},m=function(){ot=_old;if(s()){U.popState({},"",B.state.replace(/\/$/,"")+(ot===""?"/":ot))}else{tt=P;if(I){if(B.history){z.hash="#"+h(ot,P)}else{z.replace("#"+h(ot,P))}}else if(ot!=a()){if(B.history){z.hash="#"+h(ot,P)}else{z.replace("#"+h(ot,P))}}if(F&&!K&&B.history){X(y,50)}if(I){X(function(){tt=H},1)}else{tt=H}}},g=function(){if(B.tracker!=="null"&&B.tracker!==C){var t=e.isFunction(B.tracker)?B.tracker:q[B.tracker],n=(z.pathname+z.search+(e.address&&!s()?e.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");if(e.isFunction(t)){t(n)}else if(e.isFunction(q.urchinTracker)){q.urchinTracker(n)}else if(q.pageTracker!==N&&e.isFunction(q.pageTracker._trackPageview)){q.pageTracker._trackPageview(n)}else if(q._gaq!==N&&e.isFunction(q._gaq.push)){q._gaq.push(["_trackPageview",decodeURI(n)])}}},y=function(){var e=l()+":"+H+";document.open();document.writeln('<html><head><title>"+R.title.replace(/\'/g,"\\'")+"</title><script>var "+k+' = "'+encodeURIComponent(a()).replace(/\'/g,"\\'")+(R.domain!=z.hostname?'";document.domain="'+R.domain:"")+'";</'+"script></head></html>');document.close();";if(j<7){Q.src=e}else{Q.contentWindow.location.replace(e)}},b=function(){if(Y&&Z!=-1){var e,t,n=Y.substr(Z+1).split("&");for(e=0;e<n.length;e++){t=n[e].split("=");if(/^(autoUpdate|crawlable|history|strict|wrap)$/.test(t[0])){B[t[0]]=isNaN(t[1])?/^(true|yes)$/i.test(t[1]):parseInt(t[1],10)!==0}if(/^(state|tracker)$/.test(t[0])){B[t[0]]=t[1]}}Y=C}_old=ot;ot=a()},w=function(){if(!nt){nt=P;b();var n=function(){E.call(this);T.call(this)},r=e("body").ajaxComplete(n);n();if(B.wrap){var i=e("body > *").wrapAll('<div style="padding:'+(p(r,"marginTop")+p(r,"paddingTop"))+"px "+(p(r,"marginRight")+p(r,"paddingRight"))+"px "+(p(r,"marginBottom")+p(r,"paddingBottom"))+"px "+(p(r,"marginLeft")+p(r,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+k+'" style="height:100%;overflow:auto;position:relative;'+(I&&!window.statusbar.visible?"resize:both;":"")+'" />');e("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});if(I){e('<style type="text/css" />').appendTo("head").text("#"+k+"::-webkit-resizer { background-color: #fff; }")}}if(F&&!K){var o=R.getElementsByTagName("frameset")[0];Q=R.createElement((o?"":"i")+"frame");Q.src=l()+":"+H;if(o){o.insertAdjacentElement("beforeEnd",Q);o[o.cols?"cols":"rows"]+=",0";Q.noResize=P;Q.frameBorder=Q.frameSpacing=0}else{Q.style.display="none";Q.style.width=Q.style.height=0;Q.tabIndex=-1;R.body.insertAdjacentElement("afterBegin",Q)}X(function(){e(Q).bind("load",function(){var e=Q.contentWindow;_old=ot;ot=e[k]!==N?e[k]:"";if(ot!=a()){v(H);z.hash=h(ot,P)}});if(Q.contentWindow[k]===N){y()}},50)}X(function(){t("init");v(H)},1);if(!s()){if(F&&j>7||!F&&K){if(q.addEventListener){q.addEventListener(A,d,H)}else if(q.attachEvent){q.attachEvent("on"+A,d)}}else{W(d,50)}}if("state"in window.history){e(window).trigger("popstate")}}},E=function(){var t,n=e("a"),r=n.size(),i=1,s=-1,o='[rel*="address:"]',u=function(){if(++s!=r){t=e(n.get(s));if(t.is(o)){t.address(o)}X(u,i)}};X(u,i)},S=function(){if(decodeURI(ot)!=decodeURI(a())){_old=ot;ot=a();v(H)}},x=function(){if(q.removeEventListener){q.removeEventListener(A,d,H)}else if(q.detachEvent){q.detachEvent("on"+A,d)}},T=function(){if(B.crawlable){var t=z.pathname.replace(/\/$/,""),n="_escaped_fragment_";if(e("body").html().indexOf(n)!=-1){e('a[href]:not([href^=http]), a[href*="'+document.domain+'"]').each(function(){var r=e(this).attr("href").replace(/^http:/,"").replace(new RegExp(t+"/?$"),"");if(r===""||r.indexOf(n)!=-1){e(this).attr("href","#"+encodeURI(decodeURIComponent(r.replace(new RegExp("/(.*)\\?"+n+"=(.*)$"),"!$2"))))}})}}},N,C=null,k="jQueryAddress",L="string",A="hashchange",O="init",M="change",_="internalChange",D="externalChange",P=true,H=false,B={autoUpdate:P,crawlable:H,history:P,strict:P,wrap:H},j=9,F=!e.support.opacity,I=/webkit/.test(navigator.userAgent.toLowerCase()),q=f(),R=q.document,U=q.history,z=q.location,W=setInterval,X=setTimeout,V=/\/{2,9}/g,J=navigator.userAgent,K="on"+A in q,Q,G,Y=e("script:last").attr("src"),Z=Y?Y.indexOf("?"):-1,et=R.title,tt=H,nt=H,rt=P,it=H,st={},ot=a();_old=ot;if(F){j=parseFloat(J.substr(J.indexOf("MSIE")+4));if(R.documentMode&&R.documentMode!=j){j=R.documentMode!=8?7:8}var ut=R.onpropertychange;R.onpropertychange=function(){if(ut){ut.call(R)}if(R.title!=et&&R.title.indexOf("#"+a())!=-1){R.title=et}}}if(U.navigationMode){U.navigationMode="compatible"}if(document.readyState=="complete"){var at=setInterval(function(){if(e.address){w();clearInterval(at)}},50)}else{b();e(w)}e(window).bind("popstate",S).bind("unload",x);return{bind:function(e,t,i){return r.apply(this,n(arguments))},unbind:function(e,t){return i.apply(this,n(arguments))},init:function(e,t){return r.apply(this,[O].concat(n(arguments)))},change:function(e,t){return r.apply(this,[M].concat(n(arguments)))},internalChange:function(e,t){return r.apply(this,[_].concat(n(arguments)))},externalChange:function(e,t){return r.apply(this,[D].concat(n(arguments)))},baseURL:function(){var e=z.href;if(e.indexOf("#")!=-1){e=e.substr(0,e.indexOf("#"))}if(/\/$/.test(e)){e=e.substr(0,e.length-1)}return e},autoUpdate:function(e){if(e!==N){B.autoUpdate=e;return this}return B.autoUpdate},crawlable:function(e){if(e!==N){B.crawlable=e;return this}return B.crawlable},history:function(e){if(e!==N){B.history=e;return this}return B.history},state:function(e){if(e!==N){B.state=e;var t=o();if(B.state!==N){if(U.pushState){if(t.substr(0,3)=="/#/"){z.replace(B.state.replace(/^\/$/,"")+t.substr(2))}}else if(t!="/"&&t.replace(/^\/#/,"")!=u()){X(function(){z.replace(B.state.replace(/^\/$/,"")+"/#"+t)},1)}}return this}return B.state},strict:function(e){if(e!==N){B.strict=e;return this}return B.strict},tracker:function(e){if(e!==N){B.tracker=e;return this}return B.tracker},wrap:function(e){if(e!==N){B.wrap=e;return this}return B.wrap},update:function(){it=P;this.value(ot);it=H;return this},title:function(e){if(e!==N){X(function(){et=R.title=e;if(rt&&Q&&Q.contentWindow&&Q.contentWindow.document){Q.contentWindow.document.title=e;rt=H}},50);return this}return R.title},value:function(e){if(e!==N){e=c(e);if(e=="/"){e=""}if(ot==e&&!it){return}_old=ot;ot=e;if(B.autoUpdate||it){v(P);if(s()){U[B.history?"pushState":"replaceState"]({},"",B.state.replace(/\/$/,"")+(ot===""?"/":ot))}else{tt=P;if(I){if(B.history){z.hash="#"+h(ot,P)}else{z.replace("#"+h(ot,P))}}else if(ot!=a()){if(B.history){z.hash="#"+h(ot,P)}else{z.replace("#"+h(ot,P))}}if(F&&!K&&B.history){X(y,50)}if(I){X(function(){tt=H},1)}else{tt=H}}}return this}return c(ot)},path:function(e){if(e!==N){var t=this.queryString(),n=this.hash();this.value(e+(t?"?"+t:"")+(n?"#"+n:""));return this}return c(ot).split("#")[0].split("?")[0]},pathNames:function(){var e=this.path(),t=e.replace(V,"/").split("/");if(e.substr(0,1)=="/"||e.length===0){t.splice(0,1)}if(e.substr(e.length-1,1)=="/"){t.splice(t.length-1,1)}return t},queryString:function(e){if(e!==N){var t=this.hash();this.value(this.path()+(e?"?"+e:"")+(t?"#"+t:""));return this}var n=ot.split("?");return n.slice(1,n.length).join("?").split("#")[0]},parameter:function(t,n,r){var i,s;if(n!==N){var o=this.parameterNames();s=[];n=n===N||n===C?"":n.toString();for(i=0;i<o.length;i++){var u=o[i],a=this.parameter(u);if(typeof a==L){a=[a]}if(u==t){a=n===C||n===""?[]:r?a.concat([n]):[n]}for(var f=0;f<a.length;f++){s.push(u+"="+a[f])}}if(e.inArray(t,o)==-1&&n!==C&&n!==""){s.push(t+"="+n)}this.queryString(s.join("&"));return this}n=this.queryString();if(n){var l=[];s=n.split("&");for(i=0;i<s.length;i++){var c=s[i].split("=");if(c[0]==t){l.push(c.slice(1).join("="))}}if(l.length!==0){return l.length!=1?l:l[0]}}},parameterNames:function(){var t=this.queryString(),n=[];if(t&&t.indexOf("=")!=-1){var r=t.split("&");for(var i=0;i<r.length;i++){var s=r[i].split("=")[0];if(e.inArray(s,n)==-1){n.push(s)}}}return n},hash:function(e){if(e!==N){this.value(ot.split("#")[0]+(e?"#"+e:""));return this}var t=ot.split("#");return t.slice(1,t.length).join("#")}}}();e.fn.address=function(t){var n;if(typeof t=="string"){n=t;t=undefined}if(!e(this).attr("address")){var r=function(n){if(n.shiftKey||n.ctrlKey||n.metaKey||n.which==2){return true}if(e(this).is("a")){n.preventDefault();var r=t?t.call(this):/address:/.test(e(this).attr("rel"))?e(this).attr("rel").split("address:")[1].split(" ")[0]:e.address.state()!==undefined&&!/^\/?$/.test(e.address.state())?e(this).attr("href").replace(new RegExp("^(.*"+e.address.state()+"|\\.)"),""):e(this).attr("href").replace(/^(#\!?|\.)/,"");e.address.value(r)}};e(n?n:this).live("click",r).live("submit",function(n){if(e(this).is("form")){n.preventDefault();var r=e(this).attr("action"),i=t?t.call(this):(r.indexOf("?")!=-1?r.replace(/&$/,""):r+"?")+e(this).serialize();e.address.value(i)}}).attr("address",true)}return this}})(jQuery)